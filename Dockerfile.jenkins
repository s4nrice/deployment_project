FROM jenkins/jenkins:lts

USER root

# Install Docker CLI
RUN apt-get update && \
    apt-get install -y ca-certificates curl && \
    curl -fsSLO https://get.docker.com/builds/Linux/x86_64/docker-latest.tgz && \
    tar xzf docker-latest.tgz && \
    mv docker/docker /usr/local/bin/ && \
    rm -rf docker docker-latest.tgz && \
    rm -rf /var/lib/apt/lists/*

# Add jenkins user to docker group
RUN groupadd docker || true && \
    usermod -aG docker jenkins || true

USER jenkins
